# intel2gas 1.3.3 (c)1999 Mikko Tiihonen (mikko.tiihonen@hut.fi)
# Makefile by brn (c.nentwich@cs.ucl.ac.uk)

CXX = g++

# CXXFLAGS = -O6 -mpentium -malign-jumps=2 -malign-functions=2 -malign-loops=2 
# Just kidding :)

CXXFLAGS = @CXXFLAGS@
OFILES = strhandle.o loaddata.o intel2gas.o
HFILES = strhandle.h loaddata.h intel2gas.h
DATADIRS = i2g g2i m2g

prefix = @prefix@
exec_prefix = @exec_prefix@
data_prefix = $(prefix)/share/intel2gas

all: warning intel2gas

warning:
	@echo "Building intel2gas.. This might take a while!"

intel2gas: $(OFILES)
	$(CXX) $(OFILES) -o $@
	@echo "Then again... it might not."

# I hope this is allowed
$(OFILES): $(HFILES)

.cc.o:
	$(CXX) -c $(CXXFLAGS) $<

clean:
	rm -f *.o core
	find -name "*~" -exec rm {} \;

distclean: clean
	rm -f intel2gas config.status config.log config.cache Makefile i2gconf.h


install:
	install -m 755 -d $(data_prefix)
	for datadir in $(DATADIRS); do \
	  install -m 755 -d $(data_prefix)/$$datadir; \
	  cp -a $$datadir/* $(data_prefix)/$$datadir; \
	done
	install -m 755 -d $(prefix)/bin
	install -s -m 755 intel2gas $(prefix)/bin

uninstall:
	for datadir in $(DATADIRS); do \
	  rm -rf $(data_prefix)/$$datadir; \
	done
	rm -f $(prefix)/bin/intel2gas
	rmdir $(data_prefix)
